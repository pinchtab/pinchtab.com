---
import HumanAgentToggle from '@/components/ui/HumanAgentToggle.astro';
import MascotCrossfade from '@/components/ui/MascotCrossfade.astro';
import { cn } from '@/lib/utils';

const featurePills = ['Go', '12MB binary', 'HTTP API', 'MIT license', 'Zero config'];
---

<section
  class={cn(
    'relative isolate min-h-screen flex items-center justify-center',
    'pt-[80px] pb-[60px] px-6 sm:px-8 overflow-hidden'
  )}
>
  <HumanAgentToggle />

  <!-- Hero top radial glow (pseudo-element equivalent) -->
  <div
    class={cn(
      'pointer-events-none absolute left-1/2 z-0',
      'h-[860px] w-[860px] -translate-x-1/2 rounded-full'
    )}
    style="top: -320px; background: radial-gradient(circle, rgb(var(--brand-accent-rgb) / 0.12) 0%, rgb(var(--brand-accent-rgb) / 0.05) 42%, transparent 72%);"
    aria-hidden="true"
  />

  <!-- Content -->
  <div class="relative z-10 max-w-4xl mx-auto -translate-y-16 sm:-translate-y-20 lg:-translate-y-24 text-center">
    <!-- Mascot with crossfade -->
    <div class="relative z-10 mb-4 flex justify-center">
      <div class="relative">
        <MascotCrossfade
          humanImage="/mascot.png"
          agentImage="/mascot-agent.png"
          alt="PinchTab mascot"
          className="h-40 w-40 sm:h-48 sm:w-48 lg:h-56 lg:w-56 -translate-y-4 sm:-translate-y-6 lg:-translate-y-8 object-contain drop-shadow-[0_0_30px_rgb(var(--brand-accent-rgb)/0.2)]"
        />
      </div>
    </div>

    <!-- Brand name (main focal point) -->
    <h1
      class={cn(
        'relative z-20',
        'font-bold leading-[1.1] tracking-[-0.03em]',
        'text-[clamp(2.8rem,6vw,4.2rem)]',
        'mb-2'
      )}
    >
      <span class="gradient-text inline-block">
        PinchTab
      </span>
    </h1>

    <!-- Positioning line -->
    <div
      id="tagline"
      class={cn(
        'font-medium uppercase',
        'text-base tracking-[0.15em]',
        'text-brand-accent mb-5'
      )}
    >
      Browser control for AI agents
    </div>

    <!-- Supporting description -->
    <p class={cn(
      'text-[1.15rem] text-brand-text-muted leading-[1.7]',
      'max-w-[520px] mx-auto mb-8'
    )}>
      12MB Go binary. Launches Chrome, exposes an HTTP API. Any agent, any language, even curl.
    </p>

    <!-- Feature pills -->
    <div class="mb-[36px] flex flex-wrap items-center justify-center gap-[10px]">
      {
        featurePills.map((pill) => {
          const highlighted = pill === 'HTTP API';
          return (
            <span
              class={cn(
                'inline-flex items-center rounded-[20px] border',
                'px-[14px] py-[5px]',
                'text-[0.72rem] font-mono font-medium tracking-[0.01em]',
                highlighted
                  ? 'border-[rgba(251,191,36,0.30)] bg-[rgba(251,191,36,0.08)] text-brand-accent'
                  : 'border-brand-border-subtle bg-[rgba(255,255,255,0.03)] text-brand-text-muted'
              )}
            >
              {pill}
            </span>
          );
        })
      }
    </div>

    <!-- CTA Buttons -->
    <div class="flex flex-col sm:flex-row items-center justify-center gap-[14px]">
      <a
        href="https://github.com/pinchtab/pinchtab"
        class={cn(
          'inline-flex items-center justify-center',
          'w-full sm:w-auto h-12 px-7 rounded-[10px]',
          'font-semibold text-[0.9rem] leading-none',
          'bg-brand-accent text-brand-bg border border-transparent',
          'shadow-[0_8px_18px_rgb(var(--brand-accent-rgb)/0.22)]',
          'transition-all duration-200',
          'hover:bg-brand-accent-light hover:-translate-y-px hover:shadow-[0_12px_24px_rgb(var(--brand-accent-rgb)/0.28)]',
          'active:translate-y-0'
        )}
      >
        View on GitHub
      </a>
      <a
        href="/#quickstart"
        class={cn(
          'inline-flex items-center justify-center',
          'w-full sm:w-auto h-12 px-7 rounded-[10px]',
          'font-semibold text-[0.9rem] leading-none',
          'bg-[rgba(255,255,255,0.05)] border border-[rgb(var(--brand-border-subtle-rgb)/0.20)]',
          'text-brand-text',
          'shadow-[inset_0_1px_0_rgb(255_255_255/0.03)]',
          'transition-all duration-200',
          'hover:bg-[rgba(255,255,255,0.08)] hover:border-[rgb(var(--brand-border-subtle-rgb)/0.34)] hover:-translate-y-px'
        )}
      >
        Quick Start
      </a>
    </div>
  </div>
</section>

<script is:inline>
  const normalizeMode = (mode) => mode === 'agent' || mode === 'agents' ? 'agent' : 'human';

  function updateTagline(mode) {
    const taglineEl = document.getElementById('tagline');
    if (!taglineEl) return;

    if (normalizeMode(mode) === 'agent') {
      taglineEl.textContent = 'The browser you deserve';
    } else {
      taglineEl.textContent = 'Browser control for AI agents';
    }
  }

  // Listen for mode changes
  document.addEventListener('modechange', (event) => {
    updateTagline(event.detail.mode);
  });

  // Initialize with stored mode on page load
  window.addEventListener('DOMContentLoaded', () => {
    const stored = localStorage.getItem('pinchtab-mode') || 'human';
    updateTagline(stored);
  });
</script>
